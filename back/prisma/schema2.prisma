generator client {
  provider = "prisma-client-js"
  output   = "./generated/mongo"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_MONGO_URL")
}

model ChatGroup {
  id      String    @id @map("_id") @db.ObjectId
  message Message[]
}

model Message {
  id            String         @id @default(auto()) @map("_id") @db.ObjectId
  content       String
  sender        Sender? 
  statusMessage StatusMessage?
  chat          ChatGroup?     @relation(fields: [chatId], references: [id])
  chatId        String?        @db.ObjectId
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model StatusMessage {
  id        String            @id @default(auto()) @map("_id") @db.ObjectId
  message   Message?          @relation(fields: [messageId], references: [id])
  messageId String            @unique @db.ObjectId
  readBy    UserReadMessage[]
}
 
model UserReadMessage {
  id              String         @id @default(auto()) @map("_id") @db.ObjectId
  StatusMessage   StatusMessage? @relation(fields: [statusMessageId], references: [id])
  statusMessageId String?        @db.ObjectId
  userId          String
  name            String
}

model Sender {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  idUser    String
  name      String
  message   Message? @relation(fields: [messageId], references: [id])
  messageId String?  @unique @db.ObjectId
}
